{"ast":null,"code":"import _slicedToArray from\"/Users/jiayingsu/Projects/portals-ecommerce-demo-main/web/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useContext,useEffect,useState}from'react';import{IonButton,IonButtons,IonContent,IonHeader,IonItem,IonLabel,IonList,IonListHeader,IonPage,IonTitle,IonToolbar,useIonRouter}from'@ionic/react';import{DataContext}from'../../DataProvider';import'./CheckoutPage.scss';import AddressItem from'../../components/AddressItem';import PaymentItem from'../../components/PaymentItem';import Portals from'@ionic/portals';import FadeIn from'../../components/FadeIn';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var CheckoutPage=function CheckoutPage(){var _useContext=useContext(DataContext),cart=_useContext.cart,user=_useContext.user,checkout=_useContext.checkout;var _useState=useState(),_useState2=_slicedToArray(_useState,2),selectedAddress=_useState2[0],setSelectedAddress=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),selectedCreditCard=_useState4[0],setSelectedCreditCard=_useState4[1];var router=useIonRouter();useEffect(function(){if(user&&!selectedAddress){var address=user.addresses.find(function(x){return x.preferred;});if(address){setSelectedAddress(address);}}if(user&&!selectedCreditCard){var creditCard=user.creditCards.find(function(x){return x.preferred;});if(creditCard){setSelectedCreditCard(creditCard);}}},[selectedAddress,selectedCreditCard,user]);return/*#__PURE__*/_jsxs(IonPage,{id:\"checkout-page\",children:[/*#__PURE__*/_jsx(IonHeader,{children:/*#__PURE__*/_jsxs(IonToolbar,{children:[/*#__PURE__*/_jsx(IonButtons,{slot:\"start\",children:/*#__PURE__*/_jsx(IonButton,{onClick:function onClick(){Portals.publish({topic:'dismiss',data:'cancel'});},children:\"Cancel\"})}),/*#__PURE__*/_jsx(IonTitle,{children:\"Checkout\"})]})}),/*#__PURE__*/_jsx(FadeIn,{isLoaded:user!=null&&cart!=null,children:/*#__PURE__*/_jsx(IonContent,{className:\"ion-padding\",children:cart&&user&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(IonList,{lines:\"none\",children:[/*#__PURE__*/_jsx(IonListHeader,{children:\"Delivery\"}),user.addresses.map(function(address){return/*#__PURE__*/_jsx(AddressItem,{address:address,onAddressSelected:function onAddressSelected(address){return setSelectedAddress(address);},selectedId:selectedAddress===null||selectedAddress===void 0?void 0:selectedAddress.id,user:user},address.id);})]}),/*#__PURE__*/_jsx(IonButton,{expand:\"block\",color:\"secondary\",onClick:function onClick(){return router.push('/address');},children:\"New Address\"}),/*#__PURE__*/_jsxs(IonList,{lines:\"none\",children:[/*#__PURE__*/_jsx(IonListHeader,{children:\"Payment\"}),user.creditCards.map(function(creditCard){return/*#__PURE__*/_jsx(PaymentItem,{creditCard:creditCard,selectedId:selectedCreditCard===null||selectedCreditCard===void 0?void 0:selectedCreditCard.id,onPaymentSelected:function onPaymentSelected(creditCard){return setSelectedCreditCard(creditCard);},selectable:true},creditCard.id);})]}),/*#__PURE__*/_jsx(IonButton,{expand:\"block\",color:\"secondary\",onClick:function onClick(){return router.push('/payment');},children:\"New Payment Method\"}),/*#__PURE__*/_jsxs(IonList,{lines:\"none\",children:[/*#__PURE__*/_jsx(IonListHeader,{children:\"Review total\"}),/*#__PURE__*/_jsx(IonItem,{children:/*#__PURE__*/_jsxs(IonLabel,{children:[\"$\",cart.subTotal,\" + Tax\"]})})]}),/*#__PURE__*/_jsx(IonButton,{className:\"order-button\",expand:\"block\",onClick:function onClick(){var result='success';checkout({result:result});Portals.publish({topic:'dismiss',data:result});},children:\"Place Your Order\"})]})})})]});};export default CheckoutPage;","map":{"version":3,"names":["React","useContext","useEffect","useState","IonButton","IonButtons","IonContent","IonHeader","IonItem","IonLabel","IonList","IonListHeader","IonPage","IonTitle","IonToolbar","useIonRouter","DataContext","AddressItem","PaymentItem","Portals","FadeIn","CheckoutPage","cart","user","checkout","selectedAddress","setSelectedAddress","selectedCreditCard","setSelectedCreditCard","router","address","addresses","find","x","preferred","creditCard","creditCards","publish","topic","data","map","id","push","subTotal","result"],"sources":["/Users/jiayingsu/Projects/portals-ecommerce-demo-main/web/src/pages/CheckoutPage/CheckoutPage.tsx"],"sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\nimport {\n  IonButton,\n  IonButtons,\n  IonContent,\n  IonHeader,\n  IonItem,\n  IonLabel,\n  IonList,\n  IonListHeader,\n  IonPage,\n  IonTitle,\n  IonToolbar,\n  useIonRouter,\n} from '@ionic/react';\nimport { DataContext } from '../../DataProvider';\nimport './CheckoutPage.scss';\nimport { Address, CreditCard } from '../../ShopAPIPlugin';\nimport AddressItem from '../../components/AddressItem';\nimport PaymentItem from '../../components/PaymentItem';\nimport Portals from '@ionic/portals';\nimport FadeIn from '../../components/FadeIn';\n\nconst CheckoutPage: React.FC = () => {\n  const { cart, user, checkout } = useContext(DataContext);\n  const [selectedAddress, setSelectedAddress] = useState<Address>();\n  const [selectedCreditCard, setSelectedCreditCard] = useState<CreditCard>();\n  const router = useIonRouter();\n\n  useEffect(() => {\n    if (user && !selectedAddress) {\n      const address = user.addresses.find((x) => x.preferred);\n      if (address) {\n        setSelectedAddress(address);\n      }\n    }\n    if (user && !selectedCreditCard) {\n      const creditCard = user.creditCards.find((x) => x.preferred);\n      if (creditCard) {\n        setSelectedCreditCard(creditCard);\n      }\n    }\n  }, [selectedAddress, selectedCreditCard, user]);\n\n  return (\n    <IonPage id=\"checkout-page\">\n      <IonHeader>\n        <IonToolbar>\n          <IonButtons slot=\"start\">\n            <IonButton\n              onClick={() => {\n                Portals.publish({ topic: 'dismiss', data: 'cancel' });\n              }}\n            >\n              Cancel\n            </IonButton>\n          </IonButtons>\n          <IonTitle>Checkout</IonTitle>\n        </IonToolbar>\n      </IonHeader>\n      <FadeIn isLoaded={user != null && cart != null}>\n        <IonContent className=\"ion-padding\">\n          {cart && user && (\n            <>\n              <IonList lines=\"none\">\n                <IonListHeader>Delivery</IonListHeader>\n                {user.addresses.map((address) => (\n                  <AddressItem\n                    key={address.id}\n                    address={address}\n                    onAddressSelected={(address) => setSelectedAddress(address)}\n                    selectedId={selectedAddress?.id}\n                    user={user}\n                  />\n                ))}\n              </IonList>\n              <IonButton\n                expand=\"block\"\n                color=\"secondary\"\n                onClick={() => router.push('/address')}\n              >\n                New Address\n              </IonButton>\n\n              <IonList lines=\"none\">\n                <IonListHeader>Payment</IonListHeader>\n                {user.creditCards.map((creditCard) => (\n                  <PaymentItem\n                    key={creditCard.id}\n                    creditCard={creditCard}\n                    selectedId={selectedCreditCard?.id}\n                    onPaymentSelected={(creditCard) =>\n                      setSelectedCreditCard(creditCard)\n                    }\n                    selectable={true}\n                  />\n                ))}\n              </IonList>\n              <IonButton\n                expand=\"block\"\n                color=\"secondary\"\n                onClick={() => router.push('/payment')}\n              >\n                New Payment Method\n              </IonButton>\n\n              <IonList lines=\"none\">\n                <IonListHeader>Review total</IonListHeader>\n                <IonItem>\n                  <IonLabel>${cart.subTotal} + Tax</IonLabel>\n                </IonItem>\n              </IonList>\n              <IonButton\n                className=\"order-button\"\n                expand=\"block\"\n                onClick={() => {\n                  const result = 'success';\n                  checkout({ result });\n                  Portals.publish({ topic: 'dismiss', data: result });\n                }}\n              >\n                Place Your Order\n              </IonButton>\n            </>\n          )}\n        </IonContent>\n      </FadeIn>\n    </IonPage>\n  );\n};\n\nexport default CheckoutPage;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}