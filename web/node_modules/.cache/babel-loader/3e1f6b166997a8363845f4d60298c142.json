{"ast":null,"code":"import _objectSpread from\"/Users/jiayingsu/Projects/portals-ecommerce-demo-main/web/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{IonButton,IonButtons,IonContent,IonFooter,IonHeader,IonPage,IonTitle,IonToolbar}from'@ionic/react';import React,{useEffect,useRef}from'react';import Cropper from'react-cropper';import'cropperjs/dist/cropper.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ImageCropper=function ImageCropper(_ref){var image=_ref.image,onCropComplete=_ref.onCropComplete,closeModal=_ref.closeModal;var cropperRef=useRef(null);useEffect(function(){var cropper=cropperRef.current;if(cropper){cropper.addEventListener('crop',controlCropperSize);return function(){cropper.removeEventListener('crop',controlCropperSize);};}},[cropperRef]);var controlCropperSize=function controlCropperSize(event){var imageElement=cropperRef.current;var cropper=imageElement===null||imageElement===void 0?void 0:imageElement.cropper;var canvasData=cropper.getCanvasData();var cropBoxData=cropper.getCropBoxData();var canvasRight=canvasData.left+canvasData.width;var canvasBottom=canvasData.top+canvasData.height;var cropBoxRight=cropBoxData.left+cropBoxData.width;var cropBoxBottom=cropBoxData.top+cropBoxData.height;//todo limit how much you can zoom in\nif(canvasData.width<cropBoxData.width){cropper.setCanvasData(_objectSpread(_objectSpread({},canvasData),{},{width:cropBoxData.width+0.2}));event.preventDefault();}else if(canvasData.height<cropBoxData.height){cropper.setCanvasData(_objectSpread(_objectSpread({},canvasData),{},{height:cropBoxData.height+0.2}));event.preventDefault();}else if(canvasData.left>cropBoxData.left){cropper.setCanvasData(_objectSpread(_objectSpread({},canvasData),{},{left:cropBoxData.left-0.2}));event.preventDefault();}else if(canvasData.top>cropBoxData.top){cropper.setCanvasData(_objectSpread(_objectSpread({},canvasData),{},{top:cropBoxData.top-0.2}));event.preventDefault();}else if(canvasRight<cropBoxRight){cropper.setCanvasData(_objectSpread(_objectSpread({},canvasData),{},{left:cropBoxRight-canvasData.width+0.2}));event.preventDefault();}else if(canvasBottom<cropBoxBottom){cropper.setCanvasData(_objectSpread(_objectSpread({},canvasData),{},{top:cropBoxBottom-canvasData.height+0.2}));event.preventDefault();}};var handleCropImage=function handleCropImage(){var imageElement=cropperRef===null||cropperRef===void 0?void 0:cropperRef.current;var cropper=imageElement===null||imageElement===void 0?void 0:imageElement.cropper;onCropComplete(cropper.getCroppedCanvas().toDataURL());};return/*#__PURE__*/_jsxs(IonPage,{children:[/*#__PURE__*/_jsx(IonHeader,{children:/*#__PURE__*/_jsx(IonToolbar,{children:/*#__PURE__*/_jsx(IonTitle,{children:\"Adjust Image\"})})}),/*#__PURE__*/_jsxs(IonContent,{children:[/*#__PURE__*/_jsx(Cropper,{src:image,ref:cropperRef,initialAspectRatio:1,guides:true,aspectRatio:1,allowTransparency:false,background:false,dragMode:\"move\",movable:true,autoCropArea:0.9,cropBoxMovable:false,cropBoxResizable:false}),/*#__PURE__*/_jsxs(IonToolbar,{children:[/*#__PURE__*/_jsx(IonButtons,{slot:\"primary\",children:/*#__PURE__*/_jsx(IonButton,{onClick:handleCropImage,children:\"Done\"})}),/*#__PURE__*/_jsx(IonButtons,{slot:\"secondary\",children:/*#__PURE__*/_jsx(IonButton,{onClick:closeModal,children:\"Cancel\"})})]})]}),/*#__PURE__*/_jsx(IonFooter,{})]});};export default ImageCropper;","map":{"version":3,"names":["IonButton","IonButtons","IonContent","IonFooter","IonHeader","IonPage","IonTitle","IonToolbar","React","useEffect","useRef","Cropper","ImageCropper","image","onCropComplete","closeModal","cropperRef","cropper","current","addEventListener","controlCropperSize","removeEventListener","event","imageElement","canvasData","getCanvasData","cropBoxData","getCropBoxData","canvasRight","left","width","canvasBottom","top","height","cropBoxRight","cropBoxBottom","setCanvasData","preventDefault","handleCropImage","getCroppedCanvas","toDataURL"],"sources":["/Users/jiayingsu/Projects/portals-ecommerce-demo-main/web/src/components/ImageCropper.tsx"],"sourcesContent":["import {\n  IonButton,\n  IonButtons,\n  IonContent,\n  IonFooter,\n  IonHeader,\n  IonPage,\n  IonTitle,\n  IonToolbar,\n} from '@ionic/react';\nimport React, { useEffect, useRef } from 'react';\nimport Cropper from 'react-cropper';\nimport 'cropperjs/dist/cropper.css';\n\ninterface ImageCropperProps {\n  image: string;\n  onCropComplete: (dataImageUrl: string) => void;\n  closeModal: () => void;\n}\n\nconst ImageCropper: React.FC<ImageCropperProps> = ({\n  image,\n  onCropComplete,\n  closeModal\n}) => {\n  const cropperRef = useRef<HTMLImageElement>(null);\n\n  useEffect(() => {\n    const cropper = cropperRef.current;\n    if (cropper) {\n      cropper.addEventListener('crop', controlCropperSize);\n      return () => {\n        cropper.removeEventListener('crop', controlCropperSize);\n      };\n    }\n  }, [cropperRef]);\n\n  const controlCropperSize = (event: any) => {\n    const imageElement: any = cropperRef.current;\n    const cropper: any = imageElement?.cropper;\n    const canvasData = cropper.getCanvasData();\n    const cropBoxData = cropper.getCropBoxData();\n\n    const canvasRight = canvasData.left + canvasData.width;\n    const canvasBottom = canvasData.top + canvasData.height;\n    const cropBoxRight = cropBoxData.left + cropBoxData.width;\n    const cropBoxBottom = cropBoxData.top + cropBoxData.height;\n    //todo limit how much you can zoom in\n    if (canvasData.width < cropBoxData.width) {\n      cropper.setCanvasData({\n        ...canvasData,\n        width: cropBoxData.width + 0.2,\n      });\n      event.preventDefault();\n    } else if (canvasData.height < cropBoxData.height) {\n      cropper.setCanvasData({\n        ...canvasData,\n        height: cropBoxData.height + 0.2,\n      });\n      event.preventDefault();\n    } else if (canvasData.left > cropBoxData.left) {\n      cropper.setCanvasData({\n        ...canvasData,\n        left: cropBoxData.left - 0.2,\n      });\n      event.preventDefault();\n    } else if (canvasData.top > cropBoxData.top) {\n      cropper.setCanvasData({\n        ...canvasData,\n        top: cropBoxData.top - 0.2,\n      });\n      event.preventDefault();\n    } else if (canvasRight < cropBoxRight) {\n      cropper.setCanvasData({\n        ...canvasData,\n        left: cropBoxRight - canvasData.width + 0.2,\n      });\n      event.preventDefault();\n    } else if (canvasBottom < cropBoxBottom) {\n      cropper.setCanvasData({\n        ...canvasData,\n        top: cropBoxBottom - canvasData.height + 0.2,\n      });\n      event.preventDefault();\n    }\n  };\n\n  const handleCropImage = () => {\n    const imageElement: any = cropperRef?.current;\n    const cropper: any = imageElement?.cropper;\n    onCropComplete(cropper.getCroppedCanvas().toDataURL());\n  };\n\n  return (\n    <IonPage>\n      <IonHeader>\n        <IonToolbar>\n          <IonTitle>Adjust Image</IonTitle>\n        </IonToolbar>\n      </IonHeader>\n      <IonContent>\n        <Cropper\n          src={image}\n          ref={cropperRef}\n          initialAspectRatio={1}\n          guides={true}\n          aspectRatio={1}\n          allowTransparency={false}\n          background={false}\n          dragMode=\"move\"\n          movable={true}\n          autoCropArea={0.9}\n          cropBoxMovable={false}\n          cropBoxResizable={false}\n        />\n        <IonToolbar>\n          <IonButtons slot=\"primary\">\n            <IonButton onClick={handleCropImage}>Done</IonButton>\n          </IonButtons>\n          <IonButtons slot=\"secondary\">\n            <IonButton onClick={closeModal}>Cancel</IonButton>\n          </IonButtons>\n        </IonToolbar>\n      </IonContent>\n      <IonFooter></IonFooter>\n    </IonPage>\n  );\n};\n\nexport default ImageCropper;\n"],"mappings":"8IAAA,OACEA,SAAS,CACTC,UAAU,CACVC,UAAU,CACVC,SAAS,CACTC,SAAS,CACTC,OAAO,CACPC,QAAQ,CACRC,UAAU,KACL,cAAc,CACrB,MAAOC,MAAK,EAAIC,SAAS,CAAEC,MAAM,KAAQ,OAAO,CAChD,MAAOC,QAAO,KAAM,eAAe,CACnC,MAAO,4BAA4B,CAAC,wFAQpC,GAAMC,aAAyC,CAAG,QAA5CA,aAAyC,MAIzC,IAHJC,MAAK,MAALA,KAAK,CACLC,cAAc,MAAdA,cAAc,CACdC,UAAU,MAAVA,UAAU,CAEV,GAAMC,WAAU,CAAGN,MAAM,CAAmB,IAAI,CAAC,CAEjDD,SAAS,CAAC,UAAM,CACd,GAAMQ,QAAO,CAAGD,UAAU,CAACE,OAAO,CAClC,GAAID,OAAO,CAAE,CACXA,OAAO,CAACE,gBAAgB,CAAC,MAAM,CAAEC,kBAAkB,CAAC,CACpD,MAAO,WAAM,CACXH,OAAO,CAACI,mBAAmB,CAAC,MAAM,CAAED,kBAAkB,CAAC,CACzD,CAAC,CACH,CACF,CAAC,CAAE,CAACJ,UAAU,CAAC,CAAC,CAEhB,GAAMI,mBAAkB,CAAG,QAArBA,mBAAkB,CAAIE,KAAU,CAAK,CACzC,GAAMC,aAAiB,CAAGP,UAAU,CAACE,OAAO,CAC5C,GAAMD,QAAY,CAAGM,YAAY,SAAZA,YAAY,iBAAZA,YAAY,CAAEN,OAAO,CAC1C,GAAMO,WAAU,CAAGP,OAAO,CAACQ,aAAa,EAAE,CAC1C,GAAMC,YAAW,CAAGT,OAAO,CAACU,cAAc,EAAE,CAE5C,GAAMC,YAAW,CAAGJ,UAAU,CAACK,IAAI,CAAGL,UAAU,CAACM,KAAK,CACtD,GAAMC,aAAY,CAAGP,UAAU,CAACQ,GAAG,CAAGR,UAAU,CAACS,MAAM,CACvD,GAAMC,aAAY,CAAGR,WAAW,CAACG,IAAI,CAAGH,WAAW,CAACI,KAAK,CACzD,GAAMK,cAAa,CAAGT,WAAW,CAACM,GAAG,CAAGN,WAAW,CAACO,MAAM,CAC1D;AACA,GAAIT,UAAU,CAACM,KAAK,CAAGJ,WAAW,CAACI,KAAK,CAAE,CACxCb,OAAO,CAACmB,aAAa,gCAChBZ,UAAU,MACbM,KAAK,CAAEJ,WAAW,CAACI,KAAK,CAAG,GAAG,GAC9B,CACFR,KAAK,CAACe,cAAc,EAAE,CACxB,CAAC,IAAM,IAAIb,UAAU,CAACS,MAAM,CAAGP,WAAW,CAACO,MAAM,CAAE,CACjDhB,OAAO,CAACmB,aAAa,gCAChBZ,UAAU,MACbS,MAAM,CAAEP,WAAW,CAACO,MAAM,CAAG,GAAG,GAChC,CACFX,KAAK,CAACe,cAAc,EAAE,CACxB,CAAC,IAAM,IAAIb,UAAU,CAACK,IAAI,CAAGH,WAAW,CAACG,IAAI,CAAE,CAC7CZ,OAAO,CAACmB,aAAa,gCAChBZ,UAAU,MACbK,IAAI,CAAEH,WAAW,CAACG,IAAI,CAAG,GAAG,GAC5B,CACFP,KAAK,CAACe,cAAc,EAAE,CACxB,CAAC,IAAM,IAAIb,UAAU,CAACQ,GAAG,CAAGN,WAAW,CAACM,GAAG,CAAE,CAC3Cf,OAAO,CAACmB,aAAa,gCAChBZ,UAAU,MACbQ,GAAG,CAAEN,WAAW,CAACM,GAAG,CAAG,GAAG,GAC1B,CACFV,KAAK,CAACe,cAAc,EAAE,CACxB,CAAC,IAAM,IAAIT,WAAW,CAAGM,YAAY,CAAE,CACrCjB,OAAO,CAACmB,aAAa,gCAChBZ,UAAU,MACbK,IAAI,CAAEK,YAAY,CAAGV,UAAU,CAACM,KAAK,CAAG,GAAG,GAC3C,CACFR,KAAK,CAACe,cAAc,EAAE,CACxB,CAAC,IAAM,IAAIN,YAAY,CAAGI,aAAa,CAAE,CACvClB,OAAO,CAACmB,aAAa,gCAChBZ,UAAU,MACbQ,GAAG,CAAEG,aAAa,CAAGX,UAAU,CAACS,MAAM,CAAG,GAAG,GAC5C,CACFX,KAAK,CAACe,cAAc,EAAE,CACxB,CACF,CAAC,CAED,GAAMC,gBAAe,CAAG,QAAlBA,gBAAe,EAAS,CAC5B,GAAMf,aAAiB,CAAGP,UAAU,SAAVA,UAAU,iBAAVA,UAAU,CAAEE,OAAO,CAC7C,GAAMD,QAAY,CAAGM,YAAY,SAAZA,YAAY,iBAAZA,YAAY,CAAEN,OAAO,CAC1CH,cAAc,CAACG,OAAO,CAACsB,gBAAgB,EAAE,CAACC,SAAS,EAAE,CAAC,CACxD,CAAC,CAED,mBACE,MAAC,OAAO,yBACN,KAAC,SAAS,wBACR,KAAC,UAAU,wBACT,KAAC,QAAQ,2BAAwB,EACtB,EACH,cACZ,MAAC,UAAU,yBACT,KAAC,OAAO,EACN,GAAG,CAAE3B,KAAM,CACX,GAAG,CAAEG,UAAW,CAChB,kBAAkB,CAAE,CAAE,CACtB,MAAM,CAAE,IAAK,CACb,WAAW,CAAE,CAAE,CACf,iBAAiB,CAAE,KAAM,CACzB,UAAU,CAAE,KAAM,CAClB,QAAQ,CAAC,MAAM,CACf,OAAO,CAAE,IAAK,CACd,YAAY,CAAE,GAAI,CAClB,cAAc,CAAE,KAAM,CACtB,gBAAgB,CAAE,KAAM,EACxB,cACF,MAAC,UAAU,yBACT,KAAC,UAAU,EAAC,IAAI,CAAC,SAAS,uBACxB,KAAC,SAAS,EAAC,OAAO,CAAEsB,eAAgB,kBAAiB,EAC1C,cACb,KAAC,UAAU,EAAC,IAAI,CAAC,WAAW,uBAC1B,KAAC,SAAS,EAAC,OAAO,CAAEvB,UAAW,oBAAmB,EACvC,GACF,GACF,cACb,KAAC,SAAS,IAAa,GACf,CAEd,CAAC,CAED,cAAeH,aAAY"},"metadata":{},"sourceType":"module"}