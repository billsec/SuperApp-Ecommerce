{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jiayingsu/Projects/portals-ecommerce-demo-main/web/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/jiayingsu/Projects/portals-ecommerce-demo-main/web/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/jiayingsu/Projects/portals-ecommerce-demo-main/web/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from'react';import{IonButton,IonContent,IonInput,IonItem,IonLabel,IonList,IonPage}from'@ionic/react';import Portals from'@ionic/portals';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var PubSubTest=function PubSubTest(){var _useState=useState('sayHi'),_useState2=_slicedToArray(_useState,2),topic=_useState2[0],setTopic=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),portalsSubscription=_useState4[0],setPortalsSubscription=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),message=_useState6[0],setMessage=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),messageFromApp=_useState8[0],setMessageFromApp=_useState8[1];var subscribe=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var portalSubscription;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return Portals.subscribe({topic:topic},function(result){setMessageFromApp(result);});case 2:portalSubscription=_context.sent;setPortalsSubscription(portalSubscription);case 4:case\"end\":return _context.stop();}}},_callee);}));return function subscribe(){return _ref.apply(this,arguments);};}();var unsubscribe=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:Portals.unsubscribe(portalsSubscription);case 1:case\"end\":return _context2.stop();}}},_callee2);}));return function unsubscribe(){return _ref2.apply(this,arguments);};}();var publish=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:setMessageFromApp('');Portals.publish({topic:topic,data:{message:message}});case 2:case\"end\":return _context3.stop();}}},_callee3);}));return function publish(){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/_jsx(IonPage,{id:\"help-page\",children:/*#__PURE__*/_jsxs(IonContent,{children:[/*#__PURE__*/_jsxs(IonList,{children:[/*#__PURE__*/_jsxs(IonItem,{children:[/*#__PURE__*/_jsx(IonLabel,{children:\"Topic\"}),/*#__PURE__*/_jsx(IonInput,{value:topic,onIonChange:function onIonChange(e){return setTopic(e.detail.value);}})]}),/*#__PURE__*/_jsxs(IonItem,{children:[/*#__PURE__*/_jsx(IonLabel,{children:\"Message\"}),/*#__PURE__*/_jsx(IonInput,{value:message,onIonChange:function onIonChange(e){return setMessage(e.detail.value);}})]})]}),/*#__PURE__*/_jsx(IonButton,{expand:\"block\",onClick:subscribe,children:\"Subscribe\"}),/*#__PURE__*/_jsx(IonButton,{expand:\"block\",disabled:!portalsSubscription,onClick:unsubscribe,children:\"Unsubscribe\"}),/*#__PURE__*/_jsx(IonButton,{expand:\"block\",onClick:publish,children:\"Publish\"}),\"portalSubscription: \",/*#__PURE__*/_jsx(\"br\",{}),JSON.stringify(portalsSubscription),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),\"messageFromApp: \",/*#__PURE__*/_jsx(\"br\",{}),JSON.stringify(messageFromApp)]})});};export default PubSubTest;","map":{"version":3,"names":["React","useState","IonButton","IonContent","IonInput","IonItem","IonLabel","IonList","IonPage","Portals","PubSubTest","topic","setTopic","portalsSubscription","setPortalsSubscription","message","setMessage","messageFromApp","setMessageFromApp","subscribe","result","portalSubscription","unsubscribe","publish","data","e","detail","value","JSON","stringify"],"sources":["/Users/jiayingsu/Projects/portals-ecommerce-demo-main/web/src/pages/PubSubTest/PubSubTest.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport {\n  IonButton,\n  IonContent,\n  IonInput,\n  IonItem,\n  IonLabel,\n  IonList,\n  IonPage,\n} from '@ionic/react';\nimport Portals, { PortalSubscription } from '@ionic/portals';\n\n\nconst PubSubTest = () => {\n  const [topic, setTopic] = useState('sayHi');\n  const [portalsSubscription, setPortalsSubscription] =\n    useState<PortalSubscription>();\n  const [message, setMessage] = useState('');\n  const [messageFromApp, setMessageFromApp] = useState<any>();\n\n  const subscribe = async () => {\n    const portalSubscription = await Portals.subscribe(\n      {\n        topic,\n      },\n      (result) => {\n        setMessageFromApp(result);\n      }\n    );\n    setPortalsSubscription(portalSubscription);\n  };\n\n  const unsubscribe = async () => {\n    Portals.unsubscribe(portalsSubscription!);\n  };\n\n  const publish = async () => {\n    setMessageFromApp('');\n    Portals.publish({\n      topic,\n      data: { message },\n    });\n  };\n\n  return (\n    <IonPage id=\"help-page\">\n      <IonContent>\n        <IonList>\n          <IonItem>\n            <IonLabel>Topic</IonLabel>\n            <IonInput\n              value={topic}\n              onIonChange={(e) => setTopic(e.detail.value!)}\n            ></IonInput>\n          </IonItem>\n          <IonItem>\n            <IonLabel>Message</IonLabel>\n            <IonInput\n              value={message}\n              onIonChange={(e) => setMessage(e.detail.value!)}\n            ></IonInput>\n          </IonItem>\n        </IonList>\n        <IonButton expand=\"block\" onClick={subscribe}>\n          Subscribe\n        </IonButton>\n        <IonButton\n          expand=\"block\"\n          disabled={!portalsSubscription}\n          onClick={unsubscribe}\n        >\n          Unsubscribe\n        </IonButton>\n        <IonButton expand=\"block\" onClick={publish}>\n          Publish\n        </IonButton>\n        portalSubscription: <br />\n        {JSON.stringify(portalsSubscription)}\n        <br/><br/>\n        messageFromApp: <br />\n        {JSON.stringify(messageFromApp)}\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default PubSubTest;\n"],"mappings":"6bAAA,MAAOA,MAAK,EAAIC,QAAQ,KAAQ,OAAO,CACvC,OACEC,SAAS,CACTC,UAAU,CACVC,QAAQ,CACRC,OAAO,CACPC,QAAQ,CACRC,OAAO,CACPC,OAAO,KACF,cAAc,CACrB,MAAOC,QAAO,KAA8B,gBAAgB,CAAC,wFAG7D,GAAMC,WAAU,CAAG,QAAbA,WAAU,EAAS,CACvB,cAA0BT,QAAQ,CAAC,OAAO,CAAC,wCAApCU,KAAK,eAAEC,QAAQ,eACtB,eACEX,QAAQ,EAAsB,yCADzBY,mBAAmB,eAAEC,sBAAsB,eAElD,eAA8Bb,QAAQ,CAAC,EAAE,CAAC,yCAAnCc,OAAO,eAAEC,UAAU,eAC1B,eAA4Cf,QAAQ,EAAO,yCAApDgB,cAAc,eAAEC,iBAAiB,eAExC,GAAMC,UAAS,4FAAG,kLACiBV,QAAO,CAACU,SAAS,CAChD,CACER,KAAK,CAALA,KACF,CAAC,CACD,SAACS,MAAM,CAAK,CACVF,iBAAiB,CAACE,MAAM,CAAC,CAC3B,CAAC,CACF,QAPKC,kBAAkB,eAQxBP,sBAAsB,CAACO,kBAAkB,CAAC,CAAC,sDAC5C,kBAVKF,UAAS,0CAUd,CAED,GAAMG,YAAW,6FAAG,0IAClBb,OAAO,CAACa,WAAW,CAACT,mBAAmB,CAAE,CAAC,wDAC3C,kBAFKS,YAAW,2CAEhB,CAED,GAAMC,QAAO,6FAAG,0IACdL,iBAAiB,CAAC,EAAE,CAAC,CACrBT,OAAO,CAACc,OAAO,CAAC,CACdZ,KAAK,CAALA,KAAK,CACLa,IAAI,CAAE,CAAET,OAAO,CAAPA,OAAQ,CAClB,CAAC,CAAC,CAAC,wDACJ,kBANKQ,QAAO,2CAMZ,CAED,mBACE,KAAC,OAAO,EAAC,EAAE,CAAC,WAAW,uBACrB,MAAC,UAAU,yBACT,MAAC,OAAO,yBACN,MAAC,OAAO,yBACN,KAAC,QAAQ,oBAAiB,cAC1B,KAAC,QAAQ,EACP,KAAK,CAAEZ,KAAM,CACb,WAAW,CAAE,qBAACc,CAAC,QAAKb,SAAQ,CAACa,CAAC,CAACC,MAAM,CAACC,KAAK,CAAE,EAAC,EACpC,GACJ,cACV,MAAC,OAAO,yBACN,KAAC,QAAQ,sBAAmB,cAC5B,KAAC,QAAQ,EACP,KAAK,CAAEZ,OAAQ,CACf,WAAW,CAAE,qBAACU,CAAC,QAAKT,WAAU,CAACS,CAAC,CAACC,MAAM,CAACC,KAAK,CAAE,EAAC,EACtC,GACJ,GACF,cACV,KAAC,SAAS,EAAC,MAAM,CAAC,OAAO,CAAC,OAAO,CAAER,SAAU,uBAEjC,cACZ,KAAC,SAAS,EACR,MAAM,CAAC,OAAO,CACd,QAAQ,CAAE,CAACN,mBAAoB,CAC/B,OAAO,CAAES,WAAY,yBAGX,cACZ,KAAC,SAAS,EAAC,MAAM,CAAC,OAAO,CAAC,OAAO,CAAEC,OAAQ,qBAE/B,qCACQ,aAAM,CACzBK,IAAI,CAACC,SAAS,CAAChB,mBAAmB,CAAC,cACpC,aAAK,2BAAK,iCACM,aAAM,CACrBe,IAAI,CAACC,SAAS,CAACZ,cAAc,CAAC,GACpB,EACL,CAEd,CAAC,CAED,cAAeP,WAAU"},"metadata":{},"sourceType":"module"}